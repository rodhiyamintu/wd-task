(self.webpackChunktask_app=self.webpackChunktask_app||[]).push([[761],{1761:(e,t,n)=>{"use strict";n.r(t),n.d(t,{InboxModule:()=>j});var s=n(1116),i=n(9069),r=n(2290),o=n(7368),d=n(3796),a=n(4345),u=n(7688),c=n(6304),l=n(1428),g=n(8109);let p=(()=>{class e{constructor(e,t){this.fbAuth=e,this.fbDB=t,this.dbPath="/inbox",this.inboxRef=t.collection(this.dbPath)}sendMessage(e){return this.inboxRef.add(e)}allMessages(e){var t=this;return(0,c.Z)(function*(){return yield t.fbDB.collection("inbox",t=>t.where("to","array-contains",e)).valueChanges({idField:"docId"})})()}}return e.\u0275fac=function(t){return new(t||e)(o.LFG(l.zQ),o.LFG(g.ST))},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Z=n(1462),b=n(8160),h=n(1610),m=n(8445),A=n(8665),T=n(1146);const q=function(){return["/message"]},v=function(){return{height:"320px"}};let f=(()=>{class e{constructor(e,t,n,s,i,r){this.authService=e,this.userService=t,this.router=n,this.projectService=s,this.inboxService=i,this.messageService=r,this.blocked=!0,this.currentUser=null,this.users=[],this.selectedUser=[],this.progress=[]}ngOnInit(){this.currentUser=this.authService.currentUser.value,this.inbox={to:"",message:"",subject:"",oid:this.currentUser.oid,sendById:this.currentUser.uid,sendByName:this.currentUser.displayName},this.userService.getAllUsers(this.currentUser.oid).then(e=>{e.subscribe(e=>{this.users=e,this.blocked=!1})});for(let e=1;e<=10;e++)this.progress.push({name:10*e+"%",code:""+10*e})}onSubmit(e){if(console.log(e),e.valid){this.blocked=!0;let t={to:this.selectedUser,message:e.value.message,subject:e.value.subject,oid:this.currentUser.oid,sendById:this.currentUser.uid,sendByName:this.currentUser.displayName,createdAt:new Date,updatedAt:new Date};this.inboxService.sendMessage(t).then(e=>{this.messageService.add({severity:"success",summary:"Message send successfully.",closable:!1}),this.router.navigate(["/message"]),this.blocked=!1,console.log()}).catch(e=>{console.log(e)})}}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(d.e),o.Y36(a.K),o.Y36(i.F0),o.Y36(u.Y),o.Y36(p),o.Y36(r.ez))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-add"]],features:[o._Bn([r.ez])],decls:52,vars:16,consts:[[1,"wd-page","wd-page-tabed"],[1,"wd-page-title"],[1,"wd-page-title-inner"],["aria-label","breadcrumb",1,"wd-breadcrumbs"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],[3,"routerLink"],["aria-current","page",1,"breadcrumb-item","active"],[1,"wd-page-title-control"],[1,"btn","btn-primary","btn-rounded",3,"routerLink"],[1,"wd-page-body"],[1,"wd-panel"],[1,"wd-panel-body"],[3,"ngSubmit"],["messageForm","ngForm"],["type","hidden","name","sendById",3,"ngModel","ngModelChange"],["type","hidden","name","sendByName",3,"ngModel","ngModelChange"],[1,"row"],[1,"col-lg-6"],[1,"mb-3"],[1,"form-label"],["name","uid","optionLabel","displayName","optionValue","uid","display","chip","placeholder","Assigned To",3,"options","ngModel","ngModelChange"],["type","text","name","subject","placeholder","Subject","required","",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-lg-12"],["name","message",3,"ngModel","ngModelChange"],[1,"btn","btn-primary","btn-rounded",3,"disabled"],[3,"blocked"],["strokeWidth","4"],["position","top-center",3,"showTransformOptions"]],template:function(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"div",0),o.TgZ(1,"div",1),o.TgZ(2,"div",2),o.TgZ(3,"h4"),o._uU(4,"Compose"),o.qZA(),o.TgZ(5,"nav",3),o.TgZ(6,"ol",4),o.TgZ(7,"li",5),o.TgZ(8,"a",6),o._uU(9,"Dashboard"),o.qZA(),o.qZA(),o.TgZ(10,"li",5),o.TgZ(11,"a",7),o._uU(12,"Messages"),o.qZA(),o.qZA(),o.TgZ(13,"li",8),o._uU(14,"Compose"),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.TgZ(15,"div",9),o.TgZ(16,"button",10),o._uU(17,"Back"),o.qZA(),o.qZA(),o.qZA(),o.TgZ(18,"div",11),o.TgZ(19,"div",12),o.TgZ(20,"div",13),o.TgZ(21,"form",14,15),o.NdJ("ngSubmit",function(){o.CHM(e);const n=o.MAs(22);return t.onSubmit(n)}),o.TgZ(23,"input",16),o.NdJ("ngModelChange",function(e){return t.inbox.sendById=e}),o.qZA(),o.TgZ(24,"input",17),o.NdJ("ngModelChange",function(e){return t.inbox.sendByName=e}),o.qZA(),o.TgZ(25,"div",18),o.TgZ(26,"div",19),o.TgZ(27,"div",20),o.TgZ(28,"label",21),o._uU(29,"Assigned To"),o.qZA(),o._UZ(30,"br"),o.TgZ(31,"p-multiSelect",22),o.NdJ("ngModelChange",function(e){return t.selectedUser=e}),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.TgZ(32,"div",18),o.TgZ(33,"div",19),o.TgZ(34,"div",20),o.TgZ(35,"label",21),o._uU(36,"Subject"),o.qZA(),o.TgZ(37,"input",23),o.NdJ("ngModelChange",function(e){return t.inbox.subject=e}),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.TgZ(38,"div",18),o.TgZ(39,"div",24),o.TgZ(40,"div",20),o.TgZ(41,"label",21),o._uU(42,"Message"),o.qZA(),o._UZ(43,"br"),o.TgZ(44,"p-editor",25),o.NdJ("ngModelChange",function(e){return t.inbox.message=e}),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.TgZ(45,"div",18),o.TgZ(46,"div",24),o.TgZ(47,"button",26),o._uU(48,"Send"),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.TgZ(49,"p-blockUI",27),o._UZ(50,"p-progressSpinner",28),o.qZA(),o._UZ(51,"p-toast",29)}if(2&e){const e=o.MAs(22);o.xp6(11),o.Q6J("routerLink",o.DdM(13,q)),o.xp6(5),o.Q6J("routerLink",o.DdM(14,q)),o.xp6(7),o.Q6J("ngModel",t.inbox.sendById),o.xp6(1),o.Q6J("ngModel",t.inbox.sendByName),o.xp6(7),o.Q6J("options",t.users)("ngModel",t.selectedUser),o.xp6(6),o.Q6J("ngModel",t.inbox.subject),o.xp6(7),o.Akn(o.DdM(15,v)),o.Q6J("ngModel",t.inbox.message),o.xp6(3),o.Q6J("disabled",e.invalid),o.xp6(2),o.Q6J("blocked",t.blocked),o.xp6(2),o.Q6J("showTransformOptions","translateX(100%)")}},directives:[i.yS,i.rH,Z._Y,Z.JL,Z.F,Z.Fj,Z.JJ,Z.On,b.NU,Z.Q7,h.ML,m.b,A.G,T.FN],encapsulation:2}),e})();var U=n(5992),y=n(6726),w=n(7593),x=n(2886);function M(e,t){1&e&&(o.TgZ(0,"tr"),o._UZ(1,"th",17),o.TgZ(2,"th",18),o._uU(3,"Subject "),o._UZ(4,"p-sortIcon",19),o.qZA(),o.TgZ(5,"th",20),o._uU(6,"From"),o.qZA(),o.TgZ(7,"th"),o._uU(8,"Date"),o.qZA(),o.TgZ(9,"th",21),o._uU(10,"Action"),o.qZA(),o.qZA())}const _=function(e){return[e]};function S(e,t){if(1&e&&(o.TgZ(0,"tr"),o.TgZ(1,"td"),o._UZ(2,"button",22),o.qZA(),o.TgZ(3,"td"),o._uU(4),o.qZA(),o.TgZ(5,"td"),o._UZ(6,"p-chip",23),o.qZA(),o.TgZ(7,"td"),o._uU(8),o.ALo(9,"date"),o.qZA(),o.TgZ(10,"td"),o._UZ(11,"button",24),o._UZ(12,"button",25),o.qZA(),o.qZA()),2&e){const e=t.$implicit;o.xp6(2),o.Q6J("routerLink",o.VKq(8,_,"/task/"+e.docId)),o.xp6(2),o.Oqu(e.subject),o.xp6(2),o.s9C("label",e.sendByName),o.xp6(2),o.hij(" ",o.xi3(9,5,1e3*e.createdAt.seconds," LLL dd, yyyy hh:mm:aa")," "),o.xp6(3),o.Q6J("routerLink",o.VKq(10,_,"/project/edit/"+e.docId))}}const k=function(){return["/message/add"]},J=function(){return[10,25,50]},B=[{path:"",component:(()=>{class e{constructor(e,t,n,s){this.authService=e,this.userService=t,this.projectService=n,this.inboxService=s,this.currentUser=null,this.blocked=!1,this.loading=!0}ngOnInit(){this.currentUser=this.authService.currentUser.value,this.userService.getAllUsers(this.currentUser.uid).then(e=>{e.subscribe(e=>{console.log(e),this.users=e,this.loading=!1})}),this.inboxService.allMessages(this.currentUser.uid).then(e=>{e.subscribe(e=>{console.log(e),this.inboxMessages=e})})}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(d.e),o.Y36(a.K),o.Y36(u.Y),o.Y36(p))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-list"]],decls:22,vars:9,consts:[[1,"wd-page","wd-page-tabed"],[1,"wd-page-title"],[1,"wd-page-title-inner"],["aria-label","breadcrumb",1,"wd-breadcrumbs"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],["aria-current","page",1,"breadcrumb-item","active"],[1,"wd-page-title-control"],[1,"btn","btn-primary","btn-rounded",3,"routerLink"],[1,"wd-page-body"],[1,"wd-panel"],[1,"wd-panel-body"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","loading"],["dt1",""],["pTemplate","header"],["pTemplate","body"],["width","5%"],["pSortableColumn","displayName"],["field","code"],["width","20%"],["width","8%"],["pButton","","pRipple","","type","button","icon","pi pi-bars","pTooltip","Tasks","tooltipPosition","bottom",1,"p-button-rounded",3,"routerLink"],[3,"label"],["pButton","","pRipple","","icon","pi pi-eye","pTooltip","View","tooltipPosition","bottom",1,"p-button-rounded","p-button-primary","p-mr-2",3,"routerLink"],["pButton","","pRipple","","icon","pi pi-trash","pTooltip","Delete","tooltipPosition","bottom",1,"p-button-rounded","p-button-danger"]],template:function(e,t){1&e&&(o.TgZ(0,"div",0),o.TgZ(1,"div",1),o.TgZ(2,"div",2),o.TgZ(3,"h4"),o._uU(4,"Messages"),o.qZA(),o.TgZ(5,"nav",3),o.TgZ(6,"ol",4),o.TgZ(7,"li",5),o.TgZ(8,"a",6),o._uU(9,"Dashboard"),o.qZA(),o.qZA(),o.TgZ(10,"li",7),o._uU(11,"Messages"),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.TgZ(12,"div",8),o.TgZ(13,"button",9),o._uU(14,"Compose"),o.qZA(),o.qZA(),o.qZA(),o.TgZ(15,"div",10),o.TgZ(16,"div",11),o.TgZ(17,"div",12),o.TgZ(18,"p-table",13,14),o.YNc(20,M,11,0,"ng-template",15),o.YNc(21,S,13,12,"ng-template",16),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA()),2&e&&(o.xp6(13),o.Q6J("routerLink",o.DdM(7,k)),o.xp6(5),o.Q6J("value",t.inboxMessages)("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",o.DdM(8,J))("loading",t.loading))},directives:[i.rH,U.iA,r.jx,U.lQ,U.fz,y.Hq,w.u,x.A],pipes:[s.uU],styles:[""]}),e})()},{path:"add",component:f}];let C=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({imports:[[i.Bz.forChild(B)],i.Bz]}),e})();var N=n(2556),L=n(3176);let j=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({imports:[[s.ez,C,N.R,L.m]]}),e})()}}]);